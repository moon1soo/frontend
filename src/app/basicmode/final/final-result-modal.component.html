    <div class="modal-header">
        <h3 class="modal-title">
            {{'renewal2017.finalResult' | translate}}
        </h3>
        <button type="button" class="close" aria-label="Close" (click)="_activeModal.dismiss('Close Click')">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">    
        <form ngNoForm name="excelDownFormFinal" action="{{excelUrl}}" target="_blank" method="POST" #excelDownForm>
            <input name="fileName" value="{{exFileName}}" hidden>
            <input name="filePath" value="{{exFilePath}}" hidden>
            <button type="submit" id="btn-submit-excel-final" onclick="excelDownFormFinal.submit()" hidden>Download</button>
        </form>
        <div class="container-header mb-4" #header>
            <div class="float-right ml-3">
                <!-- IRB -->
                <button type="button" class="btn btn-light btn-lg btn-rounded" (click)="irbApprovals()" [disabled]="!completeFinal">
                    <i class="fal fa-vcard" aria-hidden="true"></i>
                    {{'renewal2017.irb.name' | translate}}
                </button>
                <!-- Tansepose -->
                <div ngbDropdown class= "d-inline-block">
                    <button type="button" class="btn btn-light btn-md btn-rounded" id="transpose" ngbDropdownToggle [disabled]="!activeExcel">
                        <i class="fal fa-exchange" aria-hidden="true"></i>
                        {{'renewal2017.transpose.title' | translate}}
                    </button>
                        <div ngbDropdownMenu aria-labelledby="transpose">
                            <div
                                ngbTooltip="검사에서 검사시행일, 검사세부항목명, 검사결과를 선택해야 합니다."
                                triggers="mouseenter:mouseleave"
                                container="header"
                                placement="left">
                                <button 
                                    class="dropdown-item" 
                                    (click)="openModal('exam')" 
                                    [disabled]="!examTranspose">
                                    {{'research.examination.0' | translate}}
                                </button>
                            </div>
                            <div
                                ngbTooltip="병리 검사에서 검사시행일, 병리검사결과-KEY, 병리검사결과-VALUE를 선택해야 합니다."
                                triggers="mouseenter:mouseleave"
                                container="header"
                                placement="left">              
                                <button 
                                    class="dropdown-item" 
                                    (click)="openModal('pathology')" 
                                    [disabled]="!pathTranspose">
                                    {{'renewal2017.pathology.title' | translate}}
                                </button>
                            </div>
                            <div
                                ngbTooltip="서식에서 서식작성일, 서식항목명, 서식내용을 선택해야 합니다."
                                triggers="mouseenter:mouseleave"
                                container="header"
                                placement="left"> 
                                <button 
                                    class="dropdown-item" 
                                    (click)="openModal('form')" 
                                    [disabled]="!formTranspose">
                                    {{'research.form.0' | translate}}
                                </button>
                            </div>
                            <div
                                ngbTooltip="약품에서 약품명(일반명)을 선택해야 합니다."
                                triggers="mouseenter:mouseleave"
                                container="header"
                                placement="left">
                                <button 
                                    class="dropdown-item" 
                                    (click)="openModal('medicine')" 
                                    [disabled]="!mdcnTranspose">
                                    {{'research.drug.0' | translate}}
                                </button>
                            </div>                           
                        </div>
                </div>
                <!-- Excel Download -->
                <button type="button" class="btn btn-light btn-md btn-rounded" (click)="excelDownModal()" [disabled]="!activeExcel">
                    <i class="fal fa-download" aria-hidden="true"></i>
                    {{'renewal2017.excelDownload' | translate}}
                </button>
                <!-- sql viewer -->
                <button type="button" class="btn btn-light btn-md btn-rounded" (click)="sqlViewer()" [disabled]="!sqlStr" *ngIf="adminYn">
                    <i class="fal fa-file-text" aria-hidden="true"></i>
                    {{'renewal2017.sqlViewer' | translate}}
                </button>
            </div>    
            <div class="text-left">
                <div class="row final-row">
                    <div class="col-sm-10">
                        <ngb-progressbar class="final-bar" type="info" [value]="rate">
                            <span *ngIf="rate > 0" class="progress-text">{{ rate }} %</span>
                        </ngb-progressbar>
                    </div>
                    <div class="col-sm-2 text-center mt-1">
                        <span *ngIf="rate > 0">{{'renewal2017.p.left-time' | translate}} : {{ left }}</span>
                    </div>   
                </div>                                                       
            </div>
        </div>
        <div class="bot-table-area">
            <div class="text-left">
                <span *ngIf="!completeFinal && !totalCount">서버에 데이터를 요청하고 있습니다.</span>
                <span *ngIf="completeFinal && totalCount">{{'renewal2017.finalResultTable' | translate}} </span>
                <span *ngIf="completeFinal && totalCount === 0" class="text-danger">조건을 만족하는 데이터가 없습니다.</span>
                <span *ngIf="totalCount"><b>{{totalCountComma}}</b> {{'common.cnt' | translate}}</span>
                <span *ngIf="totalCount && !completeFinal">{{'renewal2017.search' | translate}} </span>
                <span *ngIf="totalCount">{{'renewal2017.ing' | translate}} <b>{{displayCountComma}}</b> {{'common.cnt' | translate}} {{'renewal2017.print' | translate}}</span>
            </div>
            <div id="guidemodeFinalResult" class="relative-area patient-list-overflow pl-3 pr-3">
                <dx-data-grid
                    id="final-pateint-list"
                    class="resultGrid mt-4"
                    [dataSource]="tableSource"
                    [width]="gridWidth"
                    [height]="560"
                    [columns]="dynamicColumns"
                    [columnResizingMode]="'nextColumn'" 
                    [allowColumnResizing]="true"
                    (onContentReady)="onContentReady($event)"
                    (onRowClick)="onRowClick($event)">
                    <dxo-scrolling mode="virtual"></dxo-scrolling>
                    <dxo-selection mode="{{selection}}"></dxo-selection>
                    <dxo-sorting mode="single"></dxo-sorting>
                </dx-data-grid>
                <dx-load-panel
                    #loadPanel
                    shadingColor="rgba(255,255,255,0)"
                    [position]="{ of: '#guidemodeFinalResult' }"
                    [(visible)]="loading"
                    [showIndicator]="true"
                    [showPane]="true"
                    [shading]="true"
                    [closeOnOutsideClick]="false">
                </dx-load-panel>
            </div>
        </div>
        <div class="text-center">
            <button *ngIf="totalCount" type="button" class="btn btn-light btn-sm mt-3 btn-rounded" (click)="loadData()" style="width: 98%;">
                <i class="fal fa-search-plus" aria-hidden="true"></i>
                Show More
            </button>
        </div>
    </div>
    <div class="modal-footer text-right">
        <button 
            type="button" 
            class="btn btn-light btn-rounded" 
            (click)="_activeModal.close('Close Click')">
            {{'common.close' | translate}}
        </button>
    </div>
