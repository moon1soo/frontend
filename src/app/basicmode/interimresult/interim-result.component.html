<!-- <div class="tab-nav tab-accoridan">
    <h3 class="header-accoridan">
        {{'renewal2017.addItems' | translate}}
    </h3>
    
</div> -->
<form ngNoForm name="excelDownForm" action="{{excelUrl}}" target="_blank" method="POST" #excelDownForm>
    <input type="hidden" name="fileName" value="{{exFileName}}">
    <input type="hidden" name="filePath" value="{{exFilePath}}">
    <button type="submit" id="btn-submit-excel" onclick="excelDownForm.submit()" hidden>Download</button>
</form>
<vertical-split-pane
    class="vertical-split-grid progress-area"
    primary-component-minsize="600"
    secondary-component-minsize="430"
    primary-component-initialratio="0.7"
    separator-thickness="1">
    <div class="split-pane-content-primary">
        <div class="left patient-result">
            <div class="container-header">
                <div class="float-left">
                    <h3 class="title-grid-sub">
                        {{'renewal2017.conditionResultTable' | translate}}
                    </h3>                       
                </div>
                <div class="text-right">                
                    <!-- IRB Approvals -->
                    <button type="button" class="btn btn-light btn-md btn-rounded" (click)="irbApprovals()" [disabled]="!isFinished">
                        <i class="fal fa-vcard" aria-hidden="true"></i>
                        {{'renewal2017.irb.name' | translate}}
                    </button>
                    <!-- sql viewer -->
                    <button type="button" class="btn btn-light btn-md btn-rounded" (click)="sqlViewer()" *ngIf="adminYn">
                        <i class="fal fa-file-text" aria-hidden="true"></i>
                        {{'renewal2017.sqlViewer' | translate}}
                    </button>
                    <!-- 엑셀 다운로드 -->
                    <button type="button" class="btn btn-light btn-md btn-rounded" (click)="excelDownModal()" [disabled]="!activeExcel">
                        <i class="fal fa-download" aria-hidden="true"></i>
                        {{'renewal2017.excelDownload' | translate}}
                    </button>
                </div>
            </div>

            <ul class="nav nav-tabs nav-fill" (click)="beforeChange($event)">                   
                <li class="nav-item" *ngFor="let select of selectGroup">
                    <a class="nav-link init-url" routerLink="./{{select}}" skipLocationChange routerLinkActive="active">
                        <span *ngIf="select === 'concernPatient'">{{'renewal2017.concern-patient.title' | translate}}</span>
                        <span *ngIf="select === 'visit'">{{'renewal2017.treatment' | translate}}</span>
                        <span *ngIf="select === 'diagnosis'">{{'research.diagnosis.0' | translate}}</span>
                        <span *ngIf="select === 'exam' && !examResultExists">{{'research.examination.0' | translate}}</span>
                        <span *ngIf="select === 'pathology'">{{'renewal2017.pathology.title' | translate}}</span>
                        <span *ngIf="select === 'exam' && examResultExists">{{'research.examination.result.0' | translate}}</span>
                        <span *ngIf="select === 'medicine'">{{'research.drug.0' | translate}}</span>
                        <span *ngIf="select === 'order'">{{'research.order.0' | translate}}</span>
                        <span *ngIf="select === 'fee'">{{'research.cost.0' | translate}}</span>
                        <span *ngIf="select === 'surgical'">{{'research.surgery.0' | translate}}</span>
                        <span *ngIf="select === 'cc'">{{'renewal2017.cc' | translate}}</span>
                        <span *ngIf="select === 'form'">{{'research.form.0' | translate}}</span>
                        <span *ngIf="select === 'nursDiag'">{{'renewal2017.nurs.diagnosis.title' | translate}}</span>
                        <span *ngIf="select === 'nursState'">{{'renewal2017.nurs.statement.title' | translate}}</span>
                        <span *ngIf="select === 'nursEav'">{{'renewal2017.nurs.term.title' | translate}}</span>
                        <span *ngIf="select === 'nursAssm'">{{'renewal2017.nurs.assessment.common.title' | translate}}</span>
                        <span *ngIf="select === 'rediation'">{{'renewal2017.rediation.title' | translate}}</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" routerLink="./patient" skipLocationChange routerLinkActive="active" [ngClass]="{'disable-link': !ageExists}">
                        {{'research.patient.list.0' | translate}}
                    </a>
                </li>
            </ul>
            <router-outlet></router-outlet>
        </div>
    </div>
    <div class="split-pane-content-secondary">
        <div class="right">
            <h3 class="title-grid-sub">
                {{'renewal2017.resultSummary' | translate}}
            </h3>
            <ngb-accordion 
                #accInterim="ngbAccordion"
                [closeOthers]="false" 
                [destroyOnHide]="false"
                (panelChange)="beforeChange($event)"
                activeIds="{{activeId}}"
                class="vertical-accordion">
                <div *ngFor="let item of itemGroup; let idx = index">
                    <ngb-panel id="{{item}}" [disabled]="item==='patient' && ageExists===false">
                        <ng-template ngbPanelTitle>
                            <div>
                                <i class="fal fa-minus float-left mr-2" aria-hidden="true"></i>
                                <i class="fal fa-plus float-left mr-2" aria-hidden="true"></i>
                                <dl>
                                    <dt>
                                        <span *ngIf="item === 'concernPatient'">{{'renewal2017.concern-patient.title' | translate}}</span>
                                        <span *ngIf="item === 'visit'">{{'renewal2017.treatment' | translate}}</span>
                                        <span *ngIf="item === 'diagnosis'">{{'research.diagnosis.0' | translate}}</span>
                                        <span *ngIf="item === 'exam' && !examResultExists">{{'research.examination.0' | translate}}</span>
                                        <span *ngIf="item === 'pathology'">{{'renewal2017.pathology.title' | translate}}</span>
                                        <span *ngIf="item === 'exam' && examResultExists">{{'research.examination.result.0' | translate}}</span>
                                        <span *ngIf="item === 'medicine'">{{'research.drug.0' | translate}}</span>
                                        <span *ngIf="item === 'order'">{{'research.order.0' | translate}}</span>
                                        <span *ngIf="item === 'fee'">{{'research.cost.0' | translate}}</span>
                                        <span *ngIf="item === 'surgical'">{{'research.surgery.0' | translate}}</span>
                                        <span *ngIf="item === 'cc'">{{'renewal2017.cc' | translate}}</span>
                                        <span *ngIf="item === 'form'">{{'research.form.0' | translate}}</span>
                                        <span *ngIf="item === 'nursDiag'">{{'renewal2017.nurs.diagnosis.title' | translate}}</span>
                                        <span *ngIf="item === 'nursState'">{{'renewal2017.nurs.statement.title' | translate}}</span>
                                        <span *ngIf="item === 'nursEav'">{{'renewal2017.nurs.term.title' | translate}}</span>
                                        <span *ngIf="item === 'nursAssm'">{{'renewal2017.nurs.assessment.common.title' | translate}}</span>
                                        <span *ngIf="item === 'rediation'">{{'renewal2017.rediation.title' | translate}}</span>
                                        <span *ngIf="item === 'patient'">{{'renewal2017.p.patient' | translate}}</span>
                                    </dt>
                                    <dd>
                                        <span *ngIf ="item !== 'patient'">{{'renewal2017.eachCount' | translate}}</span>
                                        <span *ngFor="let cnt of totalCount">
                                            <span *ngIf="cnt.title === item && cnt.title !== 'examResult'">
                                                {{cnt.ptCount}}
                                            </span>
                                            <span *ngIf="item === 'exam' && cnt.title === 'examResult'">
                                                {{cnt.ptCount}}
                                            </span>
                                        </span>
                                        {{'renewal2017.commonPtCnt' | translate}} 
                                        <span *ngIf="item !== 'patient'"> / 
                                            <span *ngFor="let cnt of totalCount">
                                                <span *ngIf="cnt.title === item && cnt.title !== 'examResult'">
                                                    {{cnt.resultCount}}
                                                </span>
                                                <span *ngIf="item === 'exam' && cnt.title === 'examResult'">
                                                    {{cnt.resultCount}}
                                                </span>                                                
                                            </span>
                                            {{'common.cnt' | translate}}
                                        </span>
                                        <i *ngIf="item === activeId[activeId.length - 1] && !isFinished" class="fas fa-spinner fa-pulse float-right" aria-hidden="true"></i>
                                    </dd>
                                </dl>
                            </div>
                        </ng-template>
                        <ng-template ngbPanelContent>
                            <div class="text-center" *ngIf="item==='patient'">
                                <population-chart [seqCode]="'patient'"></population-chart>
                            </div>
                            <div class="text-center" *ngIf="item!=='patient'">
                                <progress-bar *ngIf="item !== 'exam'" [seqCode]="item"></progress-bar>
                                <progress-bar *ngIf="item === 'exam' && !examResultExists" [seqCode]="'exam'"></progress-bar>
                                <progress-bar *ngIf="item === 'exam' && examResultExists" [seqCode]="'examResult'"></progress-bar>
                            </div>
                        </ng-template>
                    </ngb-panel>
                </div>                                 
            </ngb-accordion>
         </div>
    </div>
</vertical-split-pane>
