<form ngNoForm name="excelDownForm" action="{{excelUrl}}" target="_blank" method="POST" #excelDownForm>
  <input type="hidden" name="fileName" value="{{exFileName}}">
  <input type="hidden" name="filePath" value="{{exFilePath}}">
  <button type="submit" id="btn-submit-cohort-excel" onclick="excelDownForm.submit()" hidden>Download</button>
</form>
<div class="dx-viewport demo-container" id="datagrid" style="margin-left: 30px;margin-right: 30px;margin-top:40px;height:calc(100% - 10px);">
  <div class="row dx-datagrid-title"><h2>{{tblCnte}}({{tblNm}})</h2>
    <span style="color:#89898a;font-size: 11px;">
      <span *ngIf="getDownloadRights()" class="float-right" style="display:grid;width:70px;"><i class="fal fa-download text-center mb-1"></i><span class="text-center">다운로드권한</span></span>
      <span *ngIf="getEditRights()" class="float-right" style="display:grid;width:70px;"><i class="fal fa-edit text-center mb-1"></i><span class="text-center">수정권한</span></span>
      <span *ngIf="getAnonymousRights()==false" class="float-right" style="display:grid;width:70px;"><i class="fal fa-eye text-center mb-1"></i><span class="text-center">비익명권한</span></span>
      <span *ngIf="getAnonymousRights()==true" class="float-right" style="display:grid;width:70px;"><i class="fal fa-eye-slash text-center mb-1"></i><span class="text-center">익명권한</span></span>
    </span>
    <span class="input-material headline col-12" style="height: 10px;margin-bottom: 10px;"></span>
  </div>
  <dx-data-grid
    id="tableData"
    [dataSource]="dataSource"
    [allowColumnResizing]="true"
    (onContentReady)="onContentReady($event)"
    (onToolbarPreparing)="onToolbarPreparing($event)"
    (onCellPrepared)="onCellPrepared($event)"
    (onRowRemoving)="deleteItem($event)"
    [columnAutoWidth]="true"
    [allowColumnReordering]="true"
    style="height:calc(100% - 100px)"
  >
    <!--dxo-editing
      [allowDeleting]="true">
      <dxo-texts deleteRow="Custom delete row msg"></dxo-texts>
    </dxo-editing//-->
    <!--dxo-header-filter [visible]="true"></dxo-header-filter//-->
    <dxo-filter-row [visible]="true"></dxo-filter-row>
    <!--dxo-column-fixing [enabled]="true"></dxo-column-fixing//-->
    <dxi-column dataField="RNUM" caption="일련번호" [visible]="true" [allowEditing]="false" cssClass="text-center"></dxi-column>
    <dxi-column dataField="PT_NO" caption="환자번호" [visible]="true" [allowEditing]="false" cssClass="text-center"></dxi-column>
    <dxi-column dataField="PT_NM" caption="환자이름" [visible]="true" [allowEditing]="false" cssClass="text-center" *ngIf="!getAnonymousRights()"></dxi-column>
    <dxi-column dataField="SEX_TP_CD" caption="성별" [visible]="true" [allowEditing]="false" cssClass="text-center" *ngIf="!getAnonymousRights()"></dxi-column>
    <dxi-column dataField="PT_BRDY_DT" caption="생년월일" [visible]="true" [allowEditing]="false" cssClass="text-center" *ngIf="!getAnonymousRights()"></dxi-column>
    <dxi-column dataField="LOAD_DTM" caption="적재일시" [visible]="true" [allowEditing]="false" cssClass="text-center"></dxi-column>
    <dxo-editing
      mode="cell"
      [allowUpdating]="true"
      [allowDeleting]="true">
      <dxo-texts confirmDeleteMessage="{{trans['delete_comment']}}"></dxo-texts>
    </dxo-editing>
    <dxo-scrolling mode="infinite"></dxo-scrolling>
    <dxo-remote-operations
      [sorting]="true"
      [paging]="true">
    </dxo-remote-operations>
    <dxo-paging [pageSize]="100"></dxo-paging>
    <dxo-sorting mode="single"></dxo-sorting>
    <div *dxTemplate="let data of 'totalCount'">
      <span class="count">( Total : {{sizePerSizeStr}} / {{totalStr}} )</span>
    </div>
    <div *dxTemplate="let data of 'txt'">
      <span> ~ </span>
    </div>
    <dx-load-panel
      #loadPanel
      shadingColor="rgba(255,255,255,0)"
      [position]="{ of: '#tableData' }"
      [(visible)]="loading"
      [showIndicator]="true"
      [showPane]="true"
      [shading]="true"
      [closeOnOutsideClick]="false">
    </dx-load-panel>
  </dx-data-grid>
</div>
